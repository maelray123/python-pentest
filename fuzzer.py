#imports
import sys
import requests 
import os 

#variables set

if sys.argv[1] == "--help":
    print("format: python fuzzer.py <target> <wordlist> <SSL *leave empty if not needed*>")
    print("help:   python fuzzer.py --help")
    print("don't put http:// or https:// in target.")

    exit()


wordlist_path = sys.argv[2]
wordlist_obj = open(wordlist_path, "r")

num = 0


if sys.argv[3] == "secure":
    SSL = "s"

validCodes = [200, 201, 202, 206]

target = sys.argv[1]

print("*disclaimer*: only use this tool on network / machines that you have the right to")

#main loop
while True:
    word = wordlist_obj.read(num)
    r = requests.get('http{}://{}/{}'.format(SSL, target, word))
    if int(r.status_code) in validCodes:
        print("{}/{} is valid!".format(target, word)) 


    num = num + 1
    if word == "":
        print("Done!"); exit()
